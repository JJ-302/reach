(this.webpackJsonpreach=this.webpackJsonpreach||[]).push([[0],{130:function(e,t,a){},131:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(36),s=a.n(o),c=(a(74),a(35)),i=a(63),l=a(64),m=a(65),u=a(5),d=a(6),f=a(8),h=a(7),p=a(9),v=a(25),C=a(26),E=a(15),g=a.n(E),k=a(13),_=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,null,[{key:"buildRequestUrl",value:function(e){return"http://localhost:3001"+e}},{key:"preparingRequest",value:function(e,t,a){switch(e){case"new":return{uriPattern:"/".concat(a),method:"POST"};case"edit":return{uriPattern:"/".concat(a,"/").concat(t),method:"PATCH"};default:return null}}},{key:"dateRangeStart",value:function(){return g()(new Date).subtract(2,"weeks").startOf("days")}},{key:"dateRangeEnd",value:function(){return g()("2020/4/1","YYYY/MM/DD")}}]),e}(),b=(a(81),function(e){return e.stopPropagation()}),y=function(e){var t=e.type,a=e.closeConfirm,r=e.title,o=e.description,s=e.confirm,c=function(e){switch(e){case"success":return{icon:["fas","check"],className:"confirm__icon--success"};case"error":return{icon:["fas","exclamation"],className:"confirm__icon--error"};case"ask":return{icon:["fas","question"],className:"confirm__icon--ask"};default:return null}}(t);return n.a.createElement("div",{className:"confirmOverlay",onClick:b},n.a.createElement("div",{className:"confirm"},c&&n.a.createElement("div",{className:c.className},n.a.createElement(k.a,{icon:c.icon})),n.a.createElement("div",{className:"confirmText"},n.a.createElement("div",{className:"confirmText__title"},r),n.a.createElement("div",{className:"confirmText__description"},o)),n.a.createElement("div",{className:"confirmButton"},"ask"===t&&n.a.createElement("div",{className:"confirmButton__cancel",onClick:a},"Cancel"),n.a.createElement("div",{className:"confirmButton__confirm",onClick:s},"OK"))))},N=(a(82),function(e){return e.errors.map((function(e){return n.a.createElement("div",{className:"error__message",key:e.error},e.error)}))}),w=function(e){var t=e.action,a=e.errors,r="".concat(t," failed!");return n.a.createElement("div",{className:"error"},n.a.createElement("div",{className:"error__title"},r),n.a.createElement(N,{errors:a}))},j="Bad request!",D="Please check your request params",S="Internal server error",R="Try reload browser",O="Updated!",x="Are you sure?",T=(a(59),function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).editProjectFormValue=function(){var e=a.props.id,t=_.buildRequestUrl("/projects/".concat(e,"/edit"));fetch(t,{method:"GET",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_authenticated,r=e.project;if(t){var n=r.name,o=r.description;a.setState({name:n,description:o})}else a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.handleCreate=function(){var e=a.state,t=e.name,r=e.description,n=a.props.id,o=_.preparingRequest(a.action,n,"projects");if(null!==o){var s=_.buildRequestUrl(o.uriPattern),c={name:t,description:r};fetch(s,{method:o.method,headers:{"Content-Type":"application/json","X-Reach-token":a.token},body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(e){var t=e.is_created,r=e.errors,n=e.project,o=a.props,s=o.closeModal,c=o.refresh;t&&"new"===a.action?(c(n,"new"),s()):t&&"edit"===a.action?(c(n.name),s()):a.setState({errors:r})})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))}},a.handleDestroy=function(){var e=a.props,t=e.id,r=e.refreshProject,n=_.buildRequestUrl("/projects/".concat(t));fetch(n,{method:"DELETE",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_delete,n=e.project;t?r(n,"destroy"):a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.openConfirm=function(e,t,r,n){a.setState({confirmVisible:!0,confirmType:e,confirmTitle:t,confirmDescription:r,confirm:n})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.onChangeName=function(e){var t=e.target.value;a.setState({name:t})},a.onChangeDescription=function(e){var t=e.target.value;a.setState({description:t})},a.onClickOverlay=function(e){e.stopPropagation()},a.token=localStorage.getItem("token");var r=a.props.action;return a.action=r,a.state={name:"",description:"",errors:[],confirmVisible:!1,confirmType:"",confirmTitle:"",confirmDescription:"",confirm:function(){}},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){"edit"===this.action&&this.editProjectFormValue()}},{key:"render",value:function(){var e=this,t=this.props.closeModal,a=this.state,r=a.name,o=a.description,s=a.errors,c=a.confirmVisible,i=a.confirmType,l=a.confirmTitle,m=a.confirmDescription,u=a.confirm,d="new"===this.action?"Create ":"Update ";return n.a.createElement("div",{className:"modalOverlay",onClick:t},n.a.createElement("div",{className:"modalForm",onClick:this.onClickOverlay},n.a.createElement("div",{className:"modalForm__title"},d,"Project"),0!==s.length&&n.a.createElement(w,{action:"Project creation",errors:s}),n.a.createElement("input",{type:"text",className:"modalForm__textInput",placeholder:"Type a project name",value:r,onChange:this.onChangeName}),n.a.createElement("textarea",{className:"modalForm__textarea",placeholder:"Type a project description",value:o,onChange:this.onChangeDescription}),n.a.createElement("button",{type:"button",onClick:this.handleCreate,className:"modalForm__button"},d),"edit"===this.action&&n.a.createElement("button",{type:"button",onClick:function(){return e.openConfirm("ask","Project ".concat("Destroy"),x,e.handleDestroy)},className:"modalForm__button--delete"},"Delete Project")),c&&n.a.createElement(y,{type:i,closeConfirm:this.closeConfirm,title:l,description:m,confirm:u}))}}]),t}(r.PureComponent)),F=a(3),V=a.n(F),P=a(12),M=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).getIndexColors=function(){var e=_.buildRequestUrl("/colors");fetch(e,{method:"GET",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_authenticated,r=e.colors;t?a.setState({colors:r}):a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.editResourceFormValue=function(){var e=a.props.id,t=_.buildRequestUrl("/resources/".concat(e,"/edit"));fetch(t,{method:"GET",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_authenticated,r=e.resource;t?a.setState({name:r.name,pickedColor:String(r.color_id)}):a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.handleCreate=function(){var e=a.props,t=e.id,r=e.closeModal,n=e.refresh,o=a.state,s=o.pickedColor,c=o.name,i=_.preparingRequest(a.action,t,"resources");if(null!==i){var l=_.buildRequestUrl(i.uriPattern),m={name:c,color_id:s};fetch(l,{method:i.method,headers:{"Content-Type":"application/json","X-Reach-token":a.token},body:JSON.stringify(m)}).then((function(e){return e.json()})).then((function(e){var t=e.errors,o=e.is_created,s=e.resource;o&&"new"===a.action?(n(s),r()):o&&"edit"===a.action?(n(),r()):a.setState({errors:t})})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))}},a.handleDestroy=function(){var e=a.props,t=e.id,r=e.refresh,n=_.buildRequestUrl("/resources/".concat(t));fetch(n,{method:"DELETE",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){e.is_delete?r():a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.openConfirm=function(e,t,r,n){a.setState({confirmVisible:!0,confirmType:e,confirmTitle:t,confirmDescription:r,confirm:n})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.onPickColor=function(e){var t=e.target.dataset.color;a.setState({pickedColor:t})},a.onChangeName=function(e){var t=e.target.value;a.setState({name:t})},a.onClickOverlay=function(e){return e.stopPropagation()};var r=a.props.action;return a.action=r,a.state={name:"",colors:[],pickedColor:"",errors:[],confirmVisible:!1,confirmType:"",confirmTitle:"",confirmDescription:"",confirm:function(){}},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(P.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("token");case 2:this.token=e.sent,this.getIndexColors(),"edit"===this.action&&this.editResourceFormValue();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t="new"===this.action?"Create ":"Update ",a=this.props.closeModal,r=this.state,o=r.name,s=r.colors,c=r.pickedColor,i=r.errors,l=r.confirmVisible,m=r.confirmType,u=r.confirmTitle,d=r.confirmDescription,f=r.confirm;return n.a.createElement("div",{className:"modalOverlay",onClick:a},n.a.createElement("div",{className:"modalForm",onClick:this.onClickOverlay},n.a.createElement("div",{className:"modalForm__title"},t,"Resource"),0!==i.length&&n.a.createElement(w,{action:"Resource creation",errors:i}),n.a.createElement("input",{type:"text",className:"modalForm__textInput",placeholder:"Type a resource name",value:o,onChange:this.onChangeName}),n.a.createElement("div",{className:"modalForm__label"},"Chart color"),n.a.createElement("div",{className:"colorPallet"},n.a.createElement(I,{colors:s,pickedColor:c,onPickColor:this.onPickColor})),n.a.createElement("button",{type:"button",onClick:this.handleCreate,className:"modalForm__button"},t),"edit"===this.action&&n.a.createElement("button",{type:"button",onClick:function(){return e.openConfirm("ask","Project ".concat("Destroy"),x,e.handleDestroy)},className:"modalForm__button--delete"},"Delete Resource")),l&&n.a.createElement(y,{type:m,closeConfirm:this.closeConfirm,title:u,description:d,confirm:f}))}}]),t}(r.PureComponent),I=function(e){var t=e.colors,a=e.pickedColor,r=e.onPickColor;return t.map((function(e){var t=a===String(e.id)?"--selected":"",o="colorPallet__body".concat(t);return n.a.createElement("div",{key:e.id,className:"colorPallet__edge"},n.a.createElement("div",{className:o,style:{backgroundColor:e.value},"data-color":e.id,onClick:r}))}))},Y=(a(47),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).getCurrentAccount=function(){var e=_.buildRequestUrl("/users/edit");fetch(e,{method:"GET",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_authenticated,r=e.user;if(t){var n=r.avatar,o=r.name,s=r.email;a.avatar=n,a.name=o,a.email=s,a.setState({uri:n,name:o,email:s})}else a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.handleUpdate=function(){var e=a.state,t=e.avatar,r=e.name,n=e.email,o=new FormData;o.append("user[name]",r),o.append("user[email]",n),t&&o.append("user[avatar]",t);var s=_.buildRequestUrl("/users/update");fetch(s,{method:"PATCH",headers:{"X-Reach-token":a.token},body:o}).then((function(e){return e.json()})).then((function(e){var t=e.is_updated,r=e.errors;t?((0,a.props.refresh)(),a.openConfirm("success",O,"",a.closeConfirm)):a.setState({errors:r})})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.onChangeFile=function(e){var t=e.target.files[0],r=URL.createObjectURL(t);a.setState({uri:r,avatar:t})},a.onChangeName=function(e){var t=e.target.value;a.setState({name:t})},a.onChangeEmail=function(e){var t=e.target.value;a.setState({email:t})},a.closeEditAccount=function(){(0,a.props.closeEditAccount)()},a.openConfirm=function(e,t,r,n){a.setState({confirmVisible:!0,confirmType:e,confirmTitle:t,confirmDescription:r,confirm:n})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.onClickOverlay=function(e){return e.stopPropagation()},a.state={uri:"",avatar:null,name:"",email:"",errors:[],confirmVisible:!1,confirmType:"",confirmTitle:"",confirmDescription:"",confirm:function(){}},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.token=localStorage.getItem("token"),this.getCurrentAccount()}},{key:"render",value:function(){var e=this.state,t=e.uri,a=e.name,r=e.email,o=e.errors,s=e.confirmVisible,c=e.confirmType,i=e.confirmTitle,l=e.confirmDescription,m=e.confirm;return n.a.createElement("div",{className:"background--edit",onClick:this.closeEditAccount},n.a.createElement("div",{className:"session",onClick:this.onClickOverlay},n.a.createElement("div",{className:"session__title"},"Edit account"),0!==o.length&&n.a.createElement(w,{action:"Registration",errors:o}),n.a.createElement("label",{htmlFor:"avatarForm",className:"session__avatar"},n.a.createElement("input",{id:"avatarForm",type:"file",className:"session__fileField",onChange:this.onChangeFile}),""===t?n.a.createElement(k.a,{icon:["fas","user"],className:"session__fileIcon"}):n.a.createElement("img",{src:t,alt:"avatar",className:"session__preview"})),n.a.createElement("div",{className:"session__fileLabel"},"Upload your avatar"),n.a.createElement("input",{type:"text",className:"session__name",placeholder:"Name",value:a,onChange:this.onChangeName}),n.a.createElement("input",{type:"text",className:"session__email",placeholder:"Email",value:r,onChange:this.onChangeEmail}),n.a.createElement("button",{type:"button",onClick:this.handleUpdate,className:"session__submit"},"Update")),s&&n.a.createElement(y,{type:c,closeConfirm:this.closeConfirm,title:i,description:l,confirm:m}))}}]),t}(r.Component)),B=(a(84),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).openProjectForm=function(){return a.setState({projectFormVisible:!0})},a.closeProjectForm=function(){return a.setState({projectFormVisible:!1})},a.openResourceForm=function(){return a.setState({resourceFormVisible:!0})},a.closeResourceForm=function(){return a.setState({resourceFormVisible:!1})},a.openEditAccount=function(){return a.setState({editAccuountVisible:!0})},a.closeEditAccount=function(){return a.setState({editAccuountVisible:!1})},a.toggleAccountMenu=function(){var e=a.state.accountMenuVisible;a.setState({accountMenuVisible:!e})},a.changeMode=function(){(0,a.props.changeMode)()},a.signOut=function(){localStorage.removeItem("token"),a.setState({isSignOut:!0})},a.state={projectFormVisible:!1,resourceFormVisible:!1,accountMenuVisible:!1,editAccuountVisible:!1,isSignOut:!1},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.refreshProject,a=e.getProjectIndex,r=e.refreshResource,o=this.state,s=o.projectFormVisible,c=o.resourceFormVisible,i=o.accountMenuVisible,l=o.editAccuountVisible;return o.isSignOut?n.a.createElement(v.a,{to:"/reach/signin"}):n.a.createElement("div",{className:"sidebar"},n.a.createElement("div",{className:"sidebar__iconWrapper--plus",onClick:this.openProjectForm},n.a.createElement(k.a,{icon:["fas","plus"],className:"sidebar__icon"})),n.a.createElement("div",{className:"sidebar__iconWrapper--minus",onClick:this.changeMode},n.a.createElement(k.a,{icon:["fas","minus"],className:"sidebar__icon"})),n.a.createElement("div",{className:"sidebar__iconWrapper--resource",onClick:this.openResourceForm},n.a.createElement(k.a,{icon:["fas","tags"],className:"sidebar__icon"})),n.a.createElement("div",{className:"sidebar__iconWrapper--account",onClick:this.toggleAccountMenu},n.a.createElement(k.a,{icon:["fas","user"],className:"sidebar__icon"})),i&&n.a.createElement("div",{className:"overlay",onClick:this.toggleAccountMenu},n.a.createElement("div",{className:"accountMenu"},n.a.createElement("div",{className:"accountMenu__edit",onClick:this.openEditAccount},"Edit account"),n.a.createElement("div",{className:"accountMenu__signout",onClick:this.signOut},"Sign out"))),s&&n.a.createElement(T,{action:"new",refresh:t,closeModal:this.closeProjectForm}),c&&n.a.createElement(M,{action:"new",refresh:r,closeModal:this.closeResourceForm}),l&&n.a.createElement(Y,{refresh:a,closeEditAccount:this.closeEditAccount}))}}]),t}(r.PureComponent)),U=a(32),A=a.n(U),W=(a(61),-1),q=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).getUserIndex=function(){var e=_.buildRequestUrl("/users");fetch(e,{method:"GET",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.users;e.is_authenticated?a.setState({users:t}):a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.search=function(){var e=a.state,t=e.projectId,r=e.taskName,n=e.startDateFrom,o=e.startDateTo,s=e.endDateFrom,c=e.endDateTo,i=e.extendFrom,l=e.extendTo,m=e.orderDuration,u=e.orderStartDate,d=e.orderEndDate,f=e.orderExtend,h=e.inCharge,p=e.selectedResources,v=_.buildRequestUrl("/tasks/search"),C={project_id:t,task_name:r,start_date:{from:n,to:o,order:u},end_date:{from:s,to:c,order:d},extend:{from:i,to:l,order:f},duration:{order:m},in_charge:h,resources:p};fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}).then((function(e){return e.json()})).then((function(e){var t=e.projects;void 0===t?a.openConfirm("error",S,R,a.closeConfirm):(0,a.props.updateProject)(t)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.sortingByDateRange=function(e){var t=a.state,r=t.startDateFrom,n=t.startDateTo,o=t.endDateFrom,s=t.endDateTo,c=t.extendFrom,i=t.extendTo,l=t.orderStartDate,m=t.orderEndDate,u=t.orderExtend;switch(e){case"start":return{rangeStart:r,rangeEnd:n,onChangeRangeStart:a.onChangeStartDateRangeS,onChangeRangeEnd:a.onChangeStartDateRangeE,order:l};case"end":return{rangeStart:o,rangeEnd:s,onChangeRangeStart:a.onChangeEndDateRangeS,onChangeRangeEnd:a.onChangeEndDateRangeE,order:m};case"extend":return{rangeStart:c,rangeEnd:i,onChangeRangeStart:a.onChangeExtendRangeS,onChangeRangeEnd:a.onChangeExtendRangeE,order:u};default:return{}}},a.openConfirm=function(e,t,r,n){a.setState({confirmVisible:!0,confirmType:e,confirmTitle:t,confirmDescription:r,confirm:n})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.onClickResource=function(){var e=a.state.searchByResourceVisible;a.setState({searchByResourceVisible:!e})},a.onClickName=function(){var e=a.state.searchByNameVisible;a.setState({searchByNameVisible:!e})},a.onClickDate=function(e){var t=e.currentTarget.dataset.type,r=a.state.searchByDateVisible;a.setState({searchByDateVisible:!r,dateType:t})},a.onClickDuration=function(){var e=a.state.searchByDurationVisible;a.setState({searchByDurationVisible:!e})},a.onClickInCharge=function(){var e=a.state.searchByUsersVisible;a.setState({searchByUsersVisible:!e})},a.onChangeOrder=function(){var e=Object(P.a)(V.a.mark((function e(t){var r,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.currentTarget.dataset.by,n=t.target.value,e.t0=r,e.next="duration"===e.t0?5:"start"===e.t0?8:"end"===e.t0?11:"extend"===e.t0?14:17;break;case 5:return e.next=7,a.setState({orderDuration:n,orderStartDate:"",orderEndDate:"",orderExtend:""});case 7:return e.abrupt("break",17);case 8:return e.next=10,a.setState({orderDuration:"",orderStartDate:n,orderEndDate:"",orderExtend:""});case 10:return e.abrupt("break",17);case 11:return e.next=13,a.setState({orderDuration:"",orderStartDate:"",orderEndDate:n,orderExtend:""});case 13:return e.abrupt("break",17);case 14:return e.next=16,a.setState({orderDuration:"",orderStartDate:"",orderEndDate:"",orderExtend:n});case 16:return e.abrupt("break",17);case 17:a.search();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeProject=function(){var e=Object(P.a)(V.a.mark((function e(t){var r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.target.value,e.next=3,a.setState({projectId:r});case 3:a.search();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeTask=function(){var e=Object(P.a)(V.a.mark((function e(t){var r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.target.value,e.next=3,a.setState({taskName:r});case 3:a.search();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeStartDateRangeS=function(){var e=Object(P.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({startDateFrom:t});case 2:a.search();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeStartDateRangeE=function(){var e=Object(P.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({startDateTo:t});case 2:a.search();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeEndDateRangeS=function(){var e=Object(P.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({endDateFrom:t});case 2:a.search();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeEndDateRangeE=function(){var e=Object(P.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({endDateTo:t}),a.search();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeExtendRangeS=function(){var e=Object(P.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({extendFrom:t});case 2:a.search();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onChangeExtendRangeE=function(){var e=Object(P.a)(V.a.mark((function e(t){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({extendTo:t});case 2:a.search();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onClickAvatar=function(){var e=Object(P.a)(V.a.mark((function e(t){var r,n,o,s;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.state.inCharge,n=r,o=t.currentTarget.dataset.id,(s=r.indexOf(o))===W?n.push(o):n.splice(s,1),e.next=7,a.setState({inCharge:n});case 7:a.search();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onClickResourceIcon=function(){var e=Object(P.a)(V.a.mark((function e(t){var r,n,o,s;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.state.selectedResources,n=r,o=t.currentTarget.dataset.id,(s=r.indexOf(o))===W?n.push(o):n.splice(s,1),e.next=7,a.setState({selectedResources:n});case 7:a.search();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.clearSearchName=Object(P.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({taskName:"",projectId:"",searchByNameVisible:!1});case 2:a.search();case 3:case"end":return e.stop()}}),e)}))),a.clearSearchStartDate=Object(P.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({startDateFrom:"",startDateTo:"",orderStartDate:"",searchByDateVisible:!1});case 2:a.search();case 3:case"end":return e.stop()}}),e)}))),a.clearSearchEndDate=Object(P.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({endDateFrom:"",endDateTo:"",orderEndDate:"",searchByDateVisible:!1});case 2:a.search();case 3:case"end":return e.stop()}}),e)}))),a.clearSearchExtend=Object(P.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({extendFrom:"",extendTo:"",orderExtend:"",searchByDateVisible:!1});case 2:a.search();case 3:case"end":return e.stop()}}),e)}))),a.clearSearchDuration=Object(P.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({orderDuration:"",searchByDurationVisible:!1});case 2:a.search();case 3:case"end":return e.stop()}}),e)}))),a.clearSearchInCharge=Object(P.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({inCharge:[],searchByUsersVisible:!1});case 2:a.search();case 3:case"end":return e.stop()}}),e)}))),a.closeAllModal=function(){a.setState({searchByNameVisible:!1,searchByDateVisible:!1,searchByDurationVisible:!1,searchByUsersVisible:!1,searchByResourceVisible:!1})},a.stopPropagation=function(e){return e.stopPropagation()},a.token=localStorage.getItem("token"),a.state={users:[],searchByNameVisible:!1,searchByDateVisible:!1,searchByDurationVisible:!1,searchByUsersVisible:!1,searchByResourceVisible:!1,dateType:"",projectId:"",taskName:"",startDateFrom:"",startDateTo:"",endDateFrom:"",endDateTo:"",extendFrom:"",extendTo:"",orderDuration:"",orderStartDate:"",orderEndDate:"",orderExtend:"",inCharge:[],selectedResources:[],confirmVisible:!1,confirmType:"",confirmTitle:"",confirmDescription:"",confirm:function(){}},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getUserIndex()}},{key:"render",value:function(){var e=this.props,t=e.projects,a=e.resources,r=this.state,o=r.users,s=r.searchByNameVisible,c=r.searchByDateVisible,i=r.searchByDurationVisible,l=r.searchByUsersVisible,m=r.searchByResourceVisible,u=r.projectId,d=r.taskName,f=r.dateType,h=r.startDateFrom,p=r.startDateTo,v=r.endDateFrom,C=r.endDateTo,E=r.extendFrom,g=r.extendTo,k=r.orderStartDate,_=r.orderEndDate,b=r.orderExtend,N=r.orderDuration,w=r.inCharge,j=r.selectedResources,D=r.confirmVisible,S=r.confirmType,R=r.confirmTitle,O=r.confirmDescription,x=r.confirm,T=0===j.length?"resourceIcon":"resourceIcon--selected",F=this.sortingByDateRange(f),V=F.rangeStart,P=F.rangeEnd,M=F.onChangeRangeStart,I=F.onChangeRangeEnd,Y=F.order;return n.a.createElement("div",{className:"gantt-index-header"},n.a.createElement("div",{className:"gantt-index-header__resource"},n.a.createElement("div",{className:T,onClick:this.onClickResource})),n.a.createElement("div",{className:"gantt-index-header__name"},""===u&&""===d?n.a.createElement("span",{className:"gantt-index-header__label",onClick:this.onClickName},"Name"):n.a.createElement("div",{className:"selected"},n.a.createElement("span",{className:"selected__label",onClick:this.onClickName},"Name"),n.a.createElement("span",{className:"selected__clear",onClick:this.clearSearchName},"\xd7"))),n.a.createElement("div",{className:"gantt-index-header__startDate"},""===h&&""===p&&""===k?n.a.createElement("span",{className:"gantt-index-header__label","data-type":"start",onClick:this.onClickDate},"StartDate"):n.a.createElement("div",{className:"selected"},n.a.createElement("span",{className:"selected__label","data-type":"start",onClick:this.onClickDate},"StartDate"),n.a.createElement("span",{className:"selected__clear",onClick:this.clearSearchStartDate},"\xd7"))),n.a.createElement("div",{className:"gantt-index-header__endDate"},""===v&&""===C&&""===_?n.a.createElement("span",{className:"gantt-index-header__label","data-type":"end",onClick:this.onClickDate},"EndDate"):n.a.createElement("div",{className:"selected"},n.a.createElement("span",{className:"selected__label","data-type":"end",onClick:this.onClickDate},"EndDate"),n.a.createElement("span",{className:"selected__clear",onClick:this.clearSearchEndDate},"\xd7"))),n.a.createElement("div",{className:"gantt-index-header__extend"},""===E&&""===g&&""===b?n.a.createElement("span",{className:"gantt-index-header__label","data-type":"extend",onClick:this.onClickDate},"Extend"):n.a.createElement("div",{className:"selected"},n.a.createElement("span",{className:"selected__label","data-type":"extend",onClick:this.onClickDate},"Extend"),n.a.createElement("span",{className:"selected__clear",onClick:this.clearSearchExtend},"\xd7"))),n.a.createElement("div",{className:"gantt-index-header__duration"},""===N?n.a.createElement("span",{className:"gantt-index-header__label",onClick:this.onClickDuration},"Duration"):n.a.createElement("div",{className:"selected"},n.a.createElement("span",{className:"selected__label",onClick:this.onClickDuration},"Duration"),n.a.createElement("span",{className:"selected__clear",onClick:this.clearSearchDuration},"\xd7"))),n.a.createElement("div",{className:"gantt-index-header__inCharge"},0===w.length?n.a.createElement("span",{className:"gantt-index-header__label",onClick:this.onClickInCharge},"InCharge"):n.a.createElement("div",{className:"selected"},n.a.createElement("span",{className:"selected__label",onClick:this.onClickInCharge},"InCharge"),n.a.createElement("span",{className:"selected__clear",onClick:this.clearSearchInCharge},"\xd7"))),m&&n.a.createElement("div",{className:"overlay",onClick:this.closeAllModal},n.a.createElement(z,{resources:a,selectedResources:j,onClickResource:this.onClickResourceIcon,stopPropagation:this.stopPropagation})),s&&n.a.createElement("div",{className:"overlay",onClick:this.closeAllModal},n.a.createElement(G,{projectId:u,projects:t,onChangeProject:this.onChangeProject,taskName:d,onChangeTask:this.onChangeTask,stopPropagation:this.stopPropagation})),c&&n.a.createElement("div",{className:"overlay",onClick:this.closeAllModal},n.a.createElement(H,{dateType:f,rangeStart:V,rangeEnd:P,onChangeRangeStart:M,onChangeRangeEnd:I,onChangeOrder:this.onChangeOrder,selected:Y,stopPropagation:this.stopPropagation})),i&&n.a.createElement("div",{className:"overlay",onClick:this.closeAllModal},n.a.createElement(L,{onChangeOrder:this.onChangeOrder,selected:N,stopPropagation:this.stopPropagation})),l&&n.a.createElement("div",{className:"overlay",onClick:this.closeAllModal},n.a.createElement(K,{users:o,inCharge:w,onClickAvatar:this.onClickAvatar,stopPropagation:this.stopPropagation})),D&&n.a.createElement(y,{type:S,closeConfirm:this.closeConfirm,title:R,description:O,confirm:x}))}}]),t}(r.Component),X=function(e){var t=e.onChangeOrder,a=e.by,r=e.selected;return n.a.createElement("select",{"data-by":a,value:r,onChange:t,className:"search__order"},n.a.createElement("option",{key:"default",value:null,"aria-label":"order"}),[{label:"ASC",value:"ASC"},{label:"DESC",value:"DESC"}].map((function(e){return n.a.createElement("option",{key:e.label,value:e.value},e.label)})))},L=function(e){var t=e.onChangeOrder,a=e.selected,r=e.stopPropagation;return n.a.createElement("div",{className:"search--duration",onClick:r},n.a.createElement("div",{className:"search__label"},"Order by duration"),n.a.createElement(X,{by:"duration",onChangeOrder:t,selected:a}),n.a.createElement("div",{className:"search__divide"}))},H=function(e){var t=e.rangeStart,a=e.rangeEnd,r=e.onChangeRangeStart,o=e.onChangeRangeEnd,s=e.dateType,c=e.onChangeOrder,i=e.order,l=e.stopPropagation,m="search--".concat(s),u="Filter by ".concat(s," date");return n.a.createElement("div",{className:m,onClick:l},n.a.createElement("div",{className:"search__label"},"Order by duration"),n.a.createElement(X,{by:s,onChangeOrder:c,selected:i}),n.a.createElement("div",{className:"search__divide"}),n.a.createElement("div",{className:"search__label"},u),n.a.createElement("div",{className:"search__dateWrapper"},n.a.createElement(A.a,{className:"search__dateRange",dateFormat:"yyyy/MM/dd",showWeekNumbers:!0,placeholderText:"Select range start",selected:t,onChange:r}),n.a.createElement(A.a,{className:"search__dateRange",dateFormat:"yyyy/MM/dd",showWeekNumbers:!0,placeholderText:"Select range end",selected:a,onChange:o})))},G=function(e){var t=e.projectId,a=e.projects,r=e.onChangeProject,o=e.taskName,s=e.onChangeTask,c=e.stopPropagation;return n.a.createElement("div",{className:"search--name",onClick:c},n.a.createElement("div",{className:"search__label"},"Filter by Project"),n.a.createElement("select",{value:t,onChange:r,className:"search__project"},n.a.createElement("option",{key:"default",value:null,"aria-label":"selectProject"}),a.map((function(e){return n.a.createElement("option",{key:e.name,value:e.id},e.name)}))),n.a.createElement("div",{className:"search__divide"}),n.a.createElement("div",{className:"search__label"},"Search by Task name"),n.a.createElement("input",{type:"text",className:"search__task",value:o,onChange:s}))},J=function(e){var t=e.users,a=e.onClickAvatar,r=e.inCharge;return t.map((function(e){var t=r.indexOf(String(e.id));return n.a.createElement("div",{key:e.id,className:"avatar"},n.a.createElement("div",{"data-id":e.id,onClick:a,className:"avatar__wrapper"},n.a.createElement("img",{src:e.avatar,alt:e.name,className:"avatar__image"}),t!==W&&n.a.createElement("div",{className:"avatar__selected"})),n.a.createElement("div",{className:"avatar__name"},e.name))}))},K=function(e){var t=e.users,a=e.inCharge,r=e.onClickAvatar,o=e.stopPropagation;return n.a.createElement("div",{className:"search--user",onClick:o},n.a.createElement("div",{className:"search__label"},"Search by users"),n.a.createElement("div",{className:"search__usersWrapper"},n.a.createElement(J,{users:t,inCharge:a,onClickAvatar:r})))},$=function(e){var t=e.resources,a=e.selectedResources,r=e.onClickResource;return t.map((function(e){var t=a.indexOf(String(e.id));return n.a.createElement("div",{key:e.id,className:"resource"},n.a.createElement("div",{"data-id":e.id,onClick:r,className:"resource__wrapper"},n.a.createElement("div",{className:"resource__icon",style:{backgroundColor:e.color}}),t!==W&&n.a.createElement("div",{className:"resource__selected"})),n.a.createElement("div",{className:"resource__name"},e.name))}))},z=function(e){var t=e.resources,a=e.selectedResources,r=e.onClickResource,o=e.stopPropagation;return n.a.createElement("div",{className:"search--resource",onClick:o},n.a.createElement("div",{className:"search__label"},"Search by resource"),n.a.createElement("div",{className:"search__resourceWrapper"},n.a.createElement($,{resources:t,selectedResources:a,onClickResource:r})))},Q=(a(130),function(e){var t=e.members;return t.map((function(e,a){return a>3?null:a<3?n.a.createElement("img",{key:e.name,src:e.avatar,alt:e.name,className:"task__avatar"}):n.a.createElement("div",{key:String(a),className:"task__avatar--length"},t.length)}))}),Z=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).handleDestroy=function(e){e.stopPropagation(),a.token=localStorage.getItem("token");var t=e.currentTarget.dataset.id,r=_.buildRequestUrl("/tasks/".concat(t));fetch(r,{method:"DELETE",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_delete,r=e.task;if(t){var n=a.props,o=n.index;(0,n.refresh)(r,o,"destroy")}else a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.openConfirm=function(e,t,r,n){a.setState({confirmVisible:!0,confirmType:e,confirmTitle:t,confirmDescription:r,confirm:n})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.onClickOverlay=function(e){return e.stopPropagation()},a.state={confirmVisible:!1,confirmType:"",confirmTitle:"",confirmDescription:"",confirm:function(){}},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.tasks,r=t.onClick,o=t.destroyMode,s=this.state,c=s.confirmVisible,i=s.confirmType,l=s.confirmTitle,m=s.confirmDescription,u=s.confirm;return a.map((function(t){var a="progress"===t.percentComplete?"task":"task--complete";return n.a.createElement("div",{key:t.id,"data-action":"edit","data-id":t.id,className:a,onClick:r},n.a.createElement("div",{className:"task__icon",onClick:e.onClickOverlay},o?n.a.createElement(k.a,{"data-id":t.id,icon:["fas","minus-circle"],className:"task__delete",onClick:e.handleDestroy}):n.a.createElement("div",{className:"task__resource",style:{backgroundColor:t.resource.color}})),n.a.createElement("div",{className:"task__name"},t.name),n.a.createElement("div",{className:"task__startDate"},t.startDate),n.a.createElement("div",{className:"task__endDate"},t.endDate),n.a.createElement("div",{className:"task__extend"},t.extend),n.a.createElement("div",{className:"task__duration"},t.duration),n.a.createElement("div",{className:"task__inCharge"},n.a.createElement(Q,{members:t.users})),c&&n.a.createElement(y,{type:i,closeConfirm:e.closeConfirm,title:l,description:m,confirm:u}))}))}}]),t}(r.Component),ee=-1,te=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).getTaskFormValue=function(){a.token=localStorage.getItem("token");var e=_.buildRequestUrl("/tasks/new");fetch(e,{method:"GET",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_authenticated,r=e.resources,n=e.users;t?a.setState({resources:r,users:n}):a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.editTaskFormValue=function(e){a.token=localStorage.getItem("token");var t=_.buildRequestUrl("/tasks/".concat(e,"/edit"));fetch(t,{method:"GET",headers:{"X-Reach-token":a.token}}).then((function(e){return e.json()})).then((function(e){var t=e.is_authenticated,r=e.resources,n=e.users;if(t){var o=e.task,s=o.description,c=o.startDate,i=o.endDate,l=o.extend,m=o.name,u=o.percentComplete,d=o.userIds,f=o.resourceId,h="complete"===u,p=d.map((function(e){return String(e)}));a.setState({resources:r,users:n,name:m,complete:h,description:s,startDate:new Date(c),endDate:l?new Date(l):new Date(i),inCharge:p,resource:f})}else a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.openConfirm=function(e,t,r,n){a.setState({confirmVisible:!0,confirmType:e,confirmTitle:t,confirmDescription:r,confirm:n})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.onChangeName=function(e){var t=e.target.value;a.setState({name:t})},a.onChangeResource=function(e){var t=e.target.value;a.setState({resource:t})},a.onChangeStartDate=function(e){a.setState({startDate:e})},a.onChangeEndDate=function(e){a.setState({endDate:e})},a.onCheck=function(){var e=a.state.complete;a.setState({complete:!e})},a.onClickAvatar=function(e){var t=a.state.inCharge,r=t,n=e.currentTarget.dataset.id,o=t.indexOf(n);o===ee?r.push(n):r.splice(o,1),a.setState({inCharge:r})},a.onChangeDescription=function(e){var t=e.target.value;a.setState({description:t})},a.createTask=function(){var e=a.props,t=e.id,r=e.taskID,n=e.action,o=a.state,s=o.name,c=o.resource,i=o.startDate,l=o.endDate,m=o.complete,u=o.inCharge,d=o.description,f=_.preparingRequest(n,r,"tasks");if(null!==f){var h=_.buildRequestUrl(f.uriPattern),p={name:s,description:d,duration:g()(l).diff(g()(i),"days"),percent_complete:m?"complete":"progress",resource_id:c,project_id:t,start_date:i,end_date:l,user_ids:u};"edit"===n&&(p.extend=l,delete p.end_date),fetch(h,{method:f.method,headers:{"X-Reach-token":a.token,"Content-Type":"application/json"},body:JSON.stringify(p)}).then((function(e){return e.json()})).then((function(e){var t=e.is_created,r=e.errors,o=e.task;if(t){var s=a.props;(0,s.refresh)(o,s.index,n),a.setState({errors:[]})}else a.setState({errors:r})})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))}},a.state={resources:[],users:[],name:"",resource:"",startDate:null,endDate:null,complete:!1,inCharge:[],description:"",errors:[],confirmVisible:!1,confirmType:"",confirmTitle:"",confirmDescription:"",confirm:function(){}},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.taskID,a=e.action;"new"===a?this.getTaskFormValue():"edit"===a&&this.editTaskFormValue(t)}},{key:"render",value:function(){var e=this.props,t=e.closeModal,a=e.action,r="edit"===a?"Update":"Add",o=this.state,s=o.users,c=o.resources,i=o.resource,l=o.name,m=o.startDate,u=o.endDate,d=o.complete,f=o.inCharge,h=o.description,p=o.errors,v=o.confirmVisible,C=o.confirmType,E=o.confirmTitle,g=o.confirmDescription,_=o.confirm;return n.a.createElement("div",{className:"taskForm"},n.a.createElement("div",{className:"taskForm__close",onClick:t},"\xd7"),n.a.createElement("div",{className:"taskForm__title"},r,"Task"),0!==p.length&&n.a.createElement(w,{action:"Task creation",errors:p}),n.a.createElement("div",{className:"taskFormRow"},n.a.createElement("div",{className:"taskFormRow__label"},"Name"),n.a.createElement("input",{type:"text",className:"taskFormRow__name",value:l,onChange:this.onChangeName})),n.a.createElement("div",{className:"taskFormRow"},n.a.createElement("div",{className:"taskFormRow__label"},"Resource"),n.a.createElement("select",{value:i,onChange:this.onChangeResource,className:"taskFormRow__resource"},n.a.createElement("option",{key:"default",value:null,"aria-label":"...select"}),n.a.createElement(ae,{resources:c})),n.a.createElement("div",{className:"taskFormRow__divide"})),n.a.createElement("div",{className:"taskFormRow"},n.a.createElement("div",{className:"taskFormRow__label"},"Start date"),n.a.createElement(A.a,{className:"taskFormRow__date",dateFormat:"yyyy/MM/dd",showWeekNumbers:!0,selected:m,onChange:this.onChangeStartDate})),n.a.createElement("div",{className:"taskFormRow"},n.a.createElement("div",{className:"taskFormRow__label"},"End date"),n.a.createElement(A.a,{className:"taskFormRow__date",dateFormat:"yyyy/MM/dd",showWeekNumbers:!0,selected:u,onChange:this.onChangeEndDate})),"edit"===a&&n.a.createElement("div",{className:"taskFormRow"},n.a.createElement("div",{className:"taskFormRow__label"},"Complete"),n.a.createElement("div",{className:"taskFormRow__complete",onClick:this.onCheck},n.a.createElement("div",{className:"taskFormRow__checkbox"},n.a.createElement(k.a,{icon:["far","square"]}),d&&n.a.createElement(k.a,{icon:["fas","check"],className:"taskFormRow__checked"})))),n.a.createElement("div",{className:"taskFormRow"},n.a.createElement("div",{className:"taskFormRow__label"},"In charge"),n.a.createElement("div",{className:"taskFormRow__inCharge"},n.a.createElement(re,{users:s,inCharge:f,onClickAvatar:this.onClickAvatar}))),n.a.createElement("div",{className:"taskFormRow"},n.a.createElement("div",{className:"taskFormRow__label"},"Description"),n.a.createElement("textarea",{className:"taskFormRow__description",value:h,onChange:this.onChangeDescription})),n.a.createElement("button",{type:"button",onClick:this.createTask,className:"taskForm__button"},r),v&&n.a.createElement(y,{type:C,closeConfirm:this.closeConfirm,title:E,description:g,confirm:_}))}}]),t}(r.Component),ae=function(e){return e.resources.map((function(e){return n.a.createElement("option",{key:e.id,value:e.id},e.name)}))},re=function(e){var t=e.users,a=e.onClickAvatar,r=e.inCharge;return t.map((function(e){var t=r.indexOf(String(e.id));return n.a.createElement("div",{key:e.id,className:"avatar"},n.a.createElement("div",{"data-id":e.id,onClick:a,className:"avatar__wrapper"},n.a.createElement("img",{src:e.avatar,alt:e.name,className:"avatar__image"}),t!==ee&&n.a.createElement("div",{className:"avatar__selected"})),n.a.createElement("div",{className:"avatar__name"},e.name))}))},ne=(a(62),function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).openModal=function(e){a.id=e.currentTarget.dataset.id||null,a.action=e.currentTarget.dataset.action,a.setState({isVisible:!0})},a.closeModal=function(){return a.setState({isVisible:!1})},a.openProjectForm=function(){return a.setState({projectFormVisible:!0})},a.closeProjectForm=function(){return a.setState({projectFormVisible:!1})},a.updateProject=function(e){return a.setState({name:e})};var r=a.props.project;return a.state={name:r.name,isVisible:!1,projectFormVisible:!1},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.project,a=e.index,r=e.refreshTask,o=e.destroyMode,s=e.refreshProject,c=t.tasks,i=t.id,l=this.state,m=l.isVisible,u=l.projectFormVisible,d=l.name;return n.a.createElement("div",{key:d,className:"project"},n.a.createElement("div",{className:"projectHeader"},n.a.createElement("div",{className:"projectHeader__name"},d),n.a.createElement(k.a,{icon:["fas","edit"],className:"projectHeader__edit",onClick:this.openProjectForm}),n.a.createElement(k.a,{icon:["fas","plus"],"data-action":"new",className:"projectHeader__addTask",onClick:this.openModal})),c&&n.a.createElement(Z,{destroyMode:o,index:a,refresh:r,tasks:c,onClick:this.openModal}),m&&n.a.createElement(te,{id:i,action:this.action,taskID:this.id,refresh:r,index:a,closeModal:this.closeModal}),u&&n.a.createElement(T,{id:i,refreshProject:s,refresh:this.updateProject,action:"edit",closeModal:this.closeProjectForm}))}}]),t}(r.Component)),oe=function(e){var t=e.projects,a=e.refreshTask,r=e.mode,o=e.refreshProject;return t.map((function(e,t){return n.a.createElement(ne,{refreshTask:a,refreshProject:o,project:e,key:e.name,index:t,destroyMode:r})}))},se=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).toggleResourceForm=function(){var e=a.state.resourceFormVisible;a.setState({resourceFormVisible:!e})},a.state={resourceFormVisible:!1},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state.resourceFormVisible,t=this.props,a=t.resource,r=t.refresh;return n.a.createElement("div",{className:"resource__wrapper",onClick:this.toggleResourceForm},n.a.createElement("div",{className:"resource__icon",style:{backgroundColor:a.color}}),n.a.createElement("div",{className:"resource__name"},a.name),e&&n.a.createElement(M,{id:a.id,action:"edit",refresh:r,closeModal:this.toggleResourceForm}))}}]),t}(r.Component),ce=(a(131),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).onMouseEnter=function(e){var t=window.innerWidth<e.clientX+300,r=window.innerHeight<e.clientY+300,n=t?e.clientX-230:e.clientX,o=r?e.clientY-150:e.clientY;a.setState({isHover:!0,offsetX:n,offsetY:o})},a.onMouseLeave=function(){return a.setState({isHover:!1})},a.state={isHover:!1,offsetX:0,offsetY:0},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.chartWidth,a=e.data,r=this.state,o=r.isHover,s=r.offsetX,c=r.offsetY;return n.a.createElement("div",{style:{width:t,backgroundColor:a.resource.color},className:"chartbar",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},o&&n.a.createElement(le,{data:a,offsetX:s,offsetY:c}))}}]),t}(r.PureComponent)),ie=function(e){return e.users.map((function(e){return n.a.createElement("div",{key:e.name,className:"windowMembers__name"},e.name)}))},le=function(e){var t=e.data,a=e.offsetX,r=e.offsetY;return n.a.createElement("div",{className:"window",style:{top:r,left:a}},n.a.createElement("div",{className:"windowRow"},n.a.createElement("div",{className:"windowRow__label"},"Name:"),n.a.createElement("div",{className:"windowRow__name"},t.name)),n.a.createElement("div",{className:"windowRow"},n.a.createElement("div",{className:"windowRow__label"},"StartDate:"),n.a.createElement("div",{className:"window__startDate"},t.startDate)),n.a.createElement("div",{className:"windowRow"},n.a.createElement("div",{className:"windowRow__label"},"EndDate:"),n.a.createElement("div",{className:"window__endDate"},t.endDate)),n.a.createElement("div",{className:"windowRow"},n.a.createElement("div",{className:"windowRow__label"},"Extend:"),n.a.createElement("div",{className:"window__extend"},t.extend)),n.a.createElement("div",{className:"windowRow"},n.a.createElement("div",{className:"windowRow__label"},"Duration:"),n.a.createElement("div",{className:"window__duration"},t.duration)),n.a.createElement("div",{className:"windowRow"},n.a.createElement("div",{className:"windowRow__label"},"Progress:"),n.a.createElement("div",{className:"window__progress"},t.percentComplete)),n.a.createElement("div",{className:"windowRow"},n.a.createElement("div",{className:"windowRow__label"},"InCharge:"),n.a.createElement("div",{className:"windowMembers"},n.a.createElement(ie,{users:t.users}))),n.a.createElement("div",{className:"windowCol"},n.a.createElement("div",{className:"windowCol__label"},"Description:"),n.a.createElement("div",{className:"windowCol__description"},t.description)))},me=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).calcOffset=function(e){return(g()(e.startDate,"YYYY/MM/DD").startOf("days").diff(a.start,"days")-1)*a.baseChartWidth},a.calcOffsetForWeeks=function(e){return Math.ceil(g()(e.startDate,"YYYY/MM/DD").startOf("week").diff(a.start,"weeks",!0))*a.baseChartWidth},a.calcChartWidthForWeeks=function(e){var t=e.extend||e.endDate,a=g()(e.startDate,"YYYY/MM/DD").startOf("week"),r=g()(t,"YYYY/MM/DD").endOf("week");return Math.ceil(r.diff(a,"weeks",!0))},a.isBefore=function(e){return g()(e.startDate,"YYYY/MM/DD").isSameOrBefore(a.start)},a.isBeforeForWeek=function(e){return g()(e.startDate,"YYYY/MM/DD").isBefore(a.start.startOf("week"))},a.start=_.dateRangeStart(),a.baseChartWidth=45,a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.scheduleType;return t.tasks.map((function(t){var r="days"===a?e.calcOffset(t):e.calcOffsetForWeeks(t),o="days"===a?t.duration:e.calcChartWidthForWeeks(t);e.isBefore(t)&&"days"===a?o-=Math.ceil(e.start.diff(g()(t.startDate,"YYYY/MM/DD").startOf("days"),"days",!0)):e.isBeforeForWeek(t)&&"weeks"===a?o-=Math.ceil(e.start.diff(g()(t.startDate,"YYYY/MM/DD"),"week",!0)):"days"===a&&(o+=1);var s=e.baseChartWidth*o,c="progress"===t.percentComplete?"task":"task--complete";return n.a.createElement("div",{key:t.id,style:{paddingLeft:r},className:c},n.a.createElement(ce,{chartWidth:s,data:t}))}))}}]),t}(r.Component),ue=function(e){return e.projects.map((function(t){return n.a.createElement("div",{key:t.name,className:"project"},n.a.createElement("div",{className:"projectHeader"}),t.tasks&&n.a.createElement(me,{tasks:t.tasks,scheduleType:e.scheduleType}))}))},de=(a(132),_.dateRangeStart()),fe=_.dateRangeEnd(),he=function(e,t){var a={};if("days"===t)a.formatDate=e.format("MMM D"),a.className="gantt-schedule-header__date".concat(function(e){switch(e.get("day")){case 0:return"--sun";case 6:return"--sat";default:return""}}(e));else{var r=e.startOf("week");a.formatDate="W".concat(e.format("W")," ").concat(r.format("M/D")),a.className="gantt-schedule-header__week"}return a},pe=function(e){for(var t=e.scheduleType,a=[],r=g()(de);r<=fe;r.add(1,t)){var o=he(r,t);a.push(n.a.createElement("div",{className:o.className,key:r.format("YYYYMMDD")},o.formatDate))}return a},ve=function(e){var t=e.scheduleType,a=e.onClick,r=e.resources,o=e.refreshResource,s={weeks:"switchView__button",days:"switchView__button"};return"weeks"===t?s.weeks+="--disable":"days"===t&&(s.days+="--disable"),n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"switchView"},n.a.createElement("div",{className:s.weeks,onClick:a,onKeyUp:a,"data-type":"weeks",role:"link",tabIndex:"0"},"Week"),n.a.createElement("div",{className:"switchView__divider"},"|"),n.a.createElement("div",{className:s.days,onClick:a,onKeyUp:a,"data-type":"days",role:"link",tabIndex:"0"},"Day")),n.a.createElement("div",{className:"resource"},r.map((function(e){return n.a.createElement(se,{refresh:o,key:e.id,resource:e})}))))},Ce=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).getProjectIndex=function(){var e=_.buildRequestUrl("/projects"),t=localStorage.getItem("token");fetch(e,{method:"GET",headers:{"X-Reach-token":t}}).then((function(e){return e.json()})).then((function(e){var t=e.is_authenticated,r=e.projects,n=e.resources;t?a.setState({projects:r,resources:n}):a.openConfirm("error",j,D,a.closeConfirm)})).catch((function(){a.openConfirm("error",S,R,a.closeConfirm)}))},a.changeScheduleType=function(e){var t=e.target.dataset.type;a.setState({type:t})},a.changeMode=function(){var e=a.state.destroyMode;a.setState({destroyMode:!e})},a.openConfirm=function(e,t,r,n){a.setState({confirmVisible:!0,confirmType:e,confirmTitle:t,confirmDescription:r,confirm:n})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.updateProject=function(e){return a.setState({projects:e})},a.refreshResource=function(e){var t=a.state.resources.slice();t.push(e),a.setState({resources:t})},a.refreshProject=function(e,t){var r=a.state.projects;if("new"===t){var n=r.slice();n.push(e),a.updateProject(n)}else if("destroy"===t){var o=r.filter((function(t){return t.id!==e.id}));a.updateProject(o)}},a.refreshTask=function(e,t,r){var n=a.state.projects;if("new"===r){var o=n.slice();o[t].tasks.push(e),a.updateProject(o)}else if("edit"===r){var s=n[t].tasks.map((function(t){return t.id===e.id?e:t})),c=n.map((function(e,a){var r=e;return t===a&&(r.tasks=s),r}));a.updateProject(c)}else if("destroy"===r){var i=n[t].tasks.filter((function(t){return t.id!==e.id})),l=n.map((function(e,a){var r=e;return t===a&&(r.tasks=i),r}));a.updateProject(l)}},a.state={resources:[],projects:[],type:"weeks",destroyMode:!1,confirmVisible:!1,confirmType:"",confirmTitle:"",confirmDescription:"",confirm:function(){}},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getProjectIndex()}},{key:"render",value:function(){var e=this.state,t=e.type,a=e.projects,r=e.resources,o=e.destroyMode,s=e.confirmVisible,c=e.confirmType,i=e.confirmTitle,l=e.confirmDescription,m=e.confirm;return n.a.createElement("div",{className:"App"},n.a.createElement(B,{getProjectIndex:this.getProjectIndex,refreshProject:this.refreshProject,refreshResource:this.refreshResource,changeMode:this.changeMode}),n.a.createElement("div",{className:"mainContainer"},n.a.createElement(ve,{resources:r,refreshResource:this.getProjectIndex,scheduleType:t,onClick:this.changeScheduleType}),n.a.createElement("div",{className:"gantt"},n.a.createElement("div",{className:"gantt-index"},n.a.createElement(q,{resources:r,projects:a,updateProject:this.updateProject}),n.a.createElement(oe,{refreshProject:this.refreshProject,refreshTask:this.refreshTask,projects:a,mode:o})),n.a.createElement("div",{className:"gantt-schedule"},n.a.createElement("div",{className:"gantt-schedule-header"},n.a.createElement(pe,{scheduleType:t})),n.a.createElement(ue,{projects:a,scheduleType:t})))),s&&n.a.createElement(y,{type:c,closeConfirm:this.closeConfirm,title:i,description:l,confirm:m}))}}]),t}(r.PureComponent),Ee=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).handleSignIn=function(){var e=a.state,t=e.email,r=e.password,n=_.buildRequestUrl("/sessions"),o={email:t,password:r};fetch(n,{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=e.result,r=e.token,n=e.errors;t?(localStorage.setItem("token",r),a.setState({isSignIn:!0})):void 0!==n?a.setState({errors:n}):a.openConfirm()})).catch((function(){a.openConfirm()}))},a.openConfirm=function(){return a.setState({confirmVisible:!0})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.emailOnChange=function(e){var t=e.target.value;a.setState({email:t})},a.passwordOnChange=function(e){var t=e.target.value;a.setState({password:t})},a.state={email:"",password:"",isSignIn:!1,errors:[],confirmVisible:!1},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,r=e.isSignIn,o=e.errors,s=e.confirmVisible;return r?n.a.createElement(v.a,{to:"/reach"}):n.a.createElement("div",{className:"background"},n.a.createElement("div",{className:"session"},n.a.createElement("div",{className:"session__title"},"Sign in to Reach"),0!==o.length&&n.a.createElement(w,{action:"Authentication",errors:o}),n.a.createElement("input",{type:"text",className:"session__email",placeholder:"Email",value:t,onChange:this.emailOnChange}),n.a.createElement("input",{type:"password",className:"session__password",placeholder:"Password",value:a,onChange:this.passwordOnChange}),n.a.createElement("button",{type:"button",onClick:this.handleSignIn,className:"session__submit"},"Sign In"),n.a.createElement(C.b,{to:"/reach/signup",className:"session__switch"},"Create account")),s&&n.a.createElement(y,{type:"error",closeConfirm:this.closeConfirm,title:S,description:R,confirm:this.closeConfirm}))}}]),t}(r.Component),ge=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(f.a)(this,Object(h.a)(t).call(this,e))).handleSignUp=function(){var e=a.state,t=e.avatar,r=e.name,n=e.email,o=e.password,s=e.passwordConfirmation,c=new FormData;c.append("user[name]",r),c.append("user[email]",n),c.append("user[password]",o),c.append("user[password_confirmation]",s),t&&c.append("user[avatar]",t);var i=_.buildRequestUrl("/users");fetch(i,{method:"POST",body:c}).then((function(e){return e.json()})).then((function(e){var t=e.is_created,r=e.errors,n=e.token;t?(localStorage.setItem("token",n),a.setState({isSignIn:!0})):void 0!==r?a.setState({errors:r}):a.openConfirm()})).catch((function(){a.openConfirm()}))},a.openConfirm=function(){return a.setState({confirmVisible:!0})},a.closeConfirm=function(){return a.setState({confirmVisible:!1})},a.onChangeFile=function(e){var t=e.target.files[0],r=URL.createObjectURL(t);a.setState({uri:r,avatar:t})},a.onChangeName=function(e){var t=e.target.value;a.setState({name:t})},a.onChangeEmail=function(e){var t=e.target.value;a.setState({email:t})},a.onChangePassword=function(e){var t=e.target.value;a.setState({password:t})},a.onChangePasswordConfirmation=function(e){var t=e.target.value;a.setState({passwordConfirmation:t})},a.state={uri:"",avatar:null,name:"",email:"",password:"",passwordConfirmation:"",errors:[],isSignIn:!1,confirmVisible:!1},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state,t=e.uri,a=e.name,r=e.email,o=e.password,s=e.passwordConfirmation,c=e.errors,i=e.isSignIn,l=e.confirmVisible;return i?n.a.createElement(v.a,{to:"/reach"}):n.a.createElement("div",{className:"background"},n.a.createElement("div",{className:"session"},n.a.createElement("div",{className:"session__title"},"Create account"),0!==c.length&&n.a.createElement(w,{action:"Registration",errors:c}),n.a.createElement("label",{htmlFor:"avatarForm",className:"session__avatar"},n.a.createElement("input",{id:"avatarForm",type:"file",className:"session__fileField",onChange:this.onChangeFile}),""===t?n.a.createElement(k.a,{icon:["fas","user"],className:"session__fileIcon"}):n.a.createElement("img",{src:t,alt:"avatar",className:"session__preview"})),n.a.createElement("div",{className:"session__fileLabel"},"Upload your avatar"),n.a.createElement("input",{type:"text",className:"session__name",placeholder:"Name",value:a,onChange:this.onChangeName}),n.a.createElement("input",{type:"text",className:"session__email",placeholder:"Email",value:r,onChange:this.onChangeEmail}),n.a.createElement("input",{type:"password",className:"session__password",placeholder:"Password",value:o,onChange:this.onChangePassword}),n.a.createElement("input",{type:"password",className:"session__password",placeholder:"Password confirmation",value:s,onChange:this.onChangePasswordConfirmation}),n.a.createElement("button",{type:"button",onClick:this.handleSignUp,className:"session__submit"},"Sign Up"),n.a.createElement(C.b,{to:"/reach/signin",className:"session__switch"},"Move to Sign In")),l&&n.a.createElement(y,{type:"error",closeConfirm:this.closeConfirm,title:S,description:R,confirm:this.closeConfirm}))}}]),t}(r.Component),ke=function(e){function t(e){var a;Object(u.a)(this,t),a=Object(f.a)(this,Object(h.a)(t).call(this,e));var r=null!==localStorage.getItem("token");return a.state={isAuthenticated:r},a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return this.state.isAuthenticated?n.a.createElement(Ce,null):n.a.createElement(v.a,{to:"/reach/signin"})}}]),t}(r.Component),_e=function(){return n.a.createElement(C.a,null,n.a.createElement(v.d,null,n.a.createElement(v.b,{path:"/reach/signin"},n.a.createElement(Ee,null)),n.a.createElement(v.b,{path:"/reach/signup"},n.a.createElement(ge,null)),n.a.createElement(v.b,{exact:!0,path:"/reach"},n.a.createElement(ke,null)),n.a.createElement(v.b,{exact:!0},n.a.createElement(Ee,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.b.add(i.a,l.a,m.a),s.a.render(n.a.createElement(_e,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},47:function(e,t,a){},59:function(e,t,a){},62:function(e,t,a){},69:function(e,t,a){e.exports=a(133)},74:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){},84:function(e,t,a){}},[[69,1,2]]]);
//# sourceMappingURL=main.0dc81e34.chunk.js.map